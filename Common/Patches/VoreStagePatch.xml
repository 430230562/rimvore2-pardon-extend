<?xml version="1.0" encoding="utf-8"?>
<Patch>

    <Operation Class="PatchOperationReplace">
        <xpath>/Defs/RimVore2.VoreStageDef[@Name="Womb_Reform"]</xpath>
        <value>
            <RimVore2.VoreStageDef Name="Womb_Reform" ParentName="Womb_Base">
                <defName>Womb_Reform</defName>
                <partGoal>Reform</partGoal>
                <jumpKey>Womb</jumpKey>
                <canReverseDirection>true</canReverseDirection>
                <predatorHediffDef>RV2_PreyInWombReforming</predatorHediffDef>
                <predatorThoughtDef>RV2_PreyInWombReforming</predatorThoughtDef>
                <onStart>
                    <actions>
                        <li Class="RimVore2.RollAction_PassValue_Set">
                            <name>ReformProgress</name>
                            <type>DigestionProgress</type>
                        </li>
                        <li Class="RimVore2.RollAction_ShowMote">
                            <mote>RV2_Mote_BubblesLove</mote>
                        </li>
                    </actions>
                </onStart>
                <onCycle>
                    <rollPresets>
                        <li>StealNeed_ForPrey_Food</li>
                        <li>Heal_Prey</li>
                        <li>Sound_Squish_Chance_30</li>
                        <li>IncreaseReformProgress</li>
                        <li>AddUnlimitedRegressionHediff</li>
                        <li>SkillAbsorb_Prey</li>
                    </rollPresets>
                </onCycle>
                <onEnd>
                    <actions>
                        <li Class="RimVore2.RollAction_Reform" />
                        <li Class="RimVore2.RollAction_RecordTale_GoalFinish" />
                    </actions>
                </onEnd>
                <passConditions>
                    <li Class="RimVore2.StagePassCondition_PassValue">
                        <passValueName>ReformProgress</passValueName>
                        <targetValue>50</targetValue>
                    </li>
                </passConditions>
            </RimVore2.VoreStageDef>
        </value>
    </Operation>

    <Operation Class='PatchOperationAdd'>
        <xpath>/Defs/RimVore2.VoreStageDef[@Name="Womb_Store"]/onCycle/rollPresets</xpath>
        <value>
            <li>AddRegressionHediff</li>
        </value>
    </Operation>

    <Operation Class='PatchOperationAdd'>
        <xpath>/Defs/RimVore2.VoreStageDef[@Name="Womb_Hold"]/onCycle/rollPresets</xpath>
        <value>
            <li>AddRegressionHediff</li>
        </value>
    </Operation>

    <Operation Class='PatchOperationAdd'>
        <xpath>/Defs/RimVore2.VoreStageDef[@Name="Womb_Pleasure"]/onCycle/rollPresets</xpath>
        <value>
            <li>AddRegressionHediff</li>
        </value>
    </Operation>

    <Operation Class='PatchOperationAdd'>
        <xpath>/Defs/RimVore2.VoreStageDef[@Name="Womb_Heal"]/onCycle/rollPresets</xpath>
        <value>
            <li>AddRegressionHediff</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace" MayRequire='Nabber.CumSlimes'>
        <xpath>/Defs/RimVore2.VoreStageDef[@Name="NCS_Testicles_Reform"]</xpath>
        <value>
            <RimVore2.VoreStageDef Name="NCS_Testicles_Reform" ParentName="Testicles_Base">
                <defName>NCS_Testicles_Reform</defName>
                <partGoal>Reform</partGoal>
                <jumpKey>Testicles</jumpKey>
                <canReverseDirection>true</canReverseDirection>
                <predatorHediffDef>RV2_PreyInTesticlesReforming</predatorHediffDef>
                <predatorThoughtDef>RV2_PreyInTesticlesReforming</predatorThoughtDef>
                <onCycle>
                    <rollPresets>
                        <li>StealNeed_ForPrey_Food</li>
                        <li>Heal_Prey</li>
                        <li>Sound_Squish_Chance_30</li>
                        <li>IncreaseReformProgress</li>
                        <li>SkillAbsorb_Prey</li>
                    </rollPresets>
                </onCycle>
                <onEnd>
                    <actions>
                        <li Class="RimVore2.RollAction_Reform">
                            <!-- setting the resulting pawnKind / race ignores predator / prey races -->
                            <resultingPawnKind>NCS_CumSlime</resultingPawnKind>
                            <resultingRace>NCS_CumSlime</resultingRace>
                            <!-- cum slimes are only female -->
                            <fixedGender>Female</fixedGender>
                        </li>
                        <li Class="RimVore2.RollAction_RecordTale_GoalFinish" />
                    </actions>
                </onEnd>
                <passConditions>
                    <li Class="RimVore2.StagePassCondition_PassValue">
                        <passValueName>ReformProgress</passValueName>
                        <targetValue>25</targetValue>
                    </li>
                </passConditions>
            </RimVore2.VoreStageDef>
        </value>
    </Operation>

</Patch>